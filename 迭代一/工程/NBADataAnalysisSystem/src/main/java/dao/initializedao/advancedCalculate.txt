update teams set win_rate = 1.0*num_of_win/num_of_match;
update teams set attack_round = shots+0.4*free_throw_shots-1.07*(1.0*offences/(offences+rival_defences)*(shots-shootings))+1.07*turn_overs;
update teams set defensive_round = shots+0.4*free_throw_shots-1.07*(1.0*defences/(defences+rival_offences)*(shots-shootings))+1.07*turn_overs;
update teams set offensive_eff = score*100.0/attack_round;
update teams set defensive_eff = rival_score*100.0/defensive_round;
update teams set defensive_rebound_eff = 1.0*defences/(defences+rival_offences);
update teams set offensive_rebound_eff = 1.0*offences/(offences+rival_defences);
update teams set steal_eff = 100.0*steals/defensive_round;
update teams set assist_rate = 100.0*assists/attack_round;
update teams set shooting_persentage = 1.0*shootings/shots;
update teams set three_point_persentage = 1.0*three_point_shootings/three_point_shots;
update teams set free_throw_persentage = 1.0*free_throw_shootings/free_throw_shots;
update players set efficiency = (score+rebounds+assists+steals+block_shots)-(shots-shootings)-(free_throw_shots-free_throw_shootings)-turn_overs;
update players set GmSc_eff = score+0.4*shootings-0.7*shots-0.4*(free_throw_shots-free_throw_shootings)+0.7*offences+0.3*defences+steals+0.7*assists+0.7*block_shots-0.4*fouls-turn_overs;
update players set ture_shooting_persentage = score/(2.0*(shots+0.44*free_throw_shots));
update players set shooting_eff = (shootings+0.5*three_point_shootings)/shots;
create table tem as select players.player_name,team,rebounds,offences,defences,assists,steals,block_shots,turn_overs,shots,free_throw_shots,three_point_shots from players;
alter table tem add rival_presence_time integer;
alter table tem add rival_rebounds integer;
alter table tem add rival_offences integer;
alter table tem add rival_defences integer;
alter table tem add rival_shots integer;
alter table tem add rival_shootings integer;
alter table tem add rival_turn_overs integer;
alter table tem add team_presence_time integer;
alter table tem add team_rebounds integer;
alter table tem add team_offences integer;
alter table tem add team_defences integer;
alter table tem add team_shots integer;
alter table tem add team_shootings integer;
alter table tem add team_turn_overs integer;
alter table tem add team_free_throw_shots integer;
alter table tem add team_three_point_shots integer;
alter table tem add rival_three_point_shots integer;
alter table tem add rival_free_throw_shots integer;
update tem set rival_three_point_shots=(select rival_three_point_shots from teams where team=teams.abbreviation);
update tem set rival_free_throw_shots=(select rival_free_throw_shots from teams where team=teams.abbreviation);
update tem set team_three_point_shots=(select three_point_shots from teams where team=teams.abbreviation);
update tem set rival_presence_time=(select rival_presence_time from teams where team=teams.abbreviation);
update tem set rival_rebounds=(select rival_rebounds from teams where team=teams.abbreviation);
update tem set rival_offences=(select rival_offences from teams where team=teams.abbreviation);
update tem set rival_defences=(select rival_defences from teams where team=teams.abbreviation);
update tem set rival_shots=(select rival_shots from teams where team=teams.abbreviation);
update tem set rival_shootings=(select rival_shootings from teams where team=teams.abbreviation);
update tem set rival_turn_overs=(select rival_turn_overs from teams where team=teams.abbreviation);
update tem set team_presence_time=(select presence_time from teams where team=teams.abbreviation);
update tem set team_rebounds=(select rebounds from teams where team=teams.abbreviation);
update tem set team_offences=(select offences from teams where team=teams.abbreviation);
update tem set team_defences=(select defences from teams where team=teams.abbreviation);
update tem set team_shots=(select shots from teams where team=teams.abbreviation);
update tem set team_shootings=(select shootings from teams where team=teams.abbreviation);
update tem set team_turn_overs=(select turn_overs from teams where team=teams.abbreviation);
update tem set team_free_throw_shots=(select free_throw_shots from teams where team=teams.abbreviation);
update players set rebound_rate =(select 1.0*rebounds*team_presence_time/5/presence_time/(team_rebounds+rival_rebounds) from tem where tem.player_name=players.player_name);
update players set offensive_rebound_rate =(select 1.0*offences*team_presence_time/5/presence_time/(team_offences+rival_offences) from tem where tem.player_name=players.player_name);
update players set defensive_rebound_rate =(select 1.0*defences*team_presence_time/5/presence_time/(team_defences+rival_defences) from tem where tem.player_name=players.player_name);
update players set assist_rate = (select 1.0*assists/(presence_time/(team_presence_time/5)*team_shootings-shootings) from tem where tem.player_name=players.player_name);
update players set steal_rate = (select 1.0*steals*(team_presence_time/5)/presence_time/rival_offences from tem where tem.player_name=players.player_name);
update players set block_shot_rate =(select 1.0*block_shots*(team_presence_time/5)/presence_time/(rival_shots-rival_three_point_shots-rival_free_throw_shots) from tem where tem.player_name=players.player_name);
update players set turn_over_rate =(select turn_overs/(shots-free_throw_shots-three_point_shots)+0.44*free_throw_shots+turn_overs from tem where players.player_name=tem.player_name);
update players set use_rate=(select (shots+0.44*free_throw_shots+turn_overs)*(team_presence_time/5)/presence_time/(team_shots+0.44*team_free_throw_shots+team_turn_overs) from tem where tem.player_name=players.player_name);
drop table tem;